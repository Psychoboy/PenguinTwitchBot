@page "/createknownbot"
@using Meziantou.AspNetCore.Components
@using System.ComponentModel.DataAnnotations
@using DotNetTwitchBot.Bot.Models;
@inject DotNetTwitchBot.Bot.Commands.Moderation.IKnownBots KnownBots
@inject Microsoft.AspNetCore.Components.NavigationManager navigationManager

<PageTitle>Create Known Bots</PageTitle>
@if (knownBot == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <MudCard>
        <EditForm Model="@knownBot" OnValidSubmit="OnSubmit">
            <MudCardContent>
                <MudTextField Label="Username" Required="true" RequiredError="Username is required"
                @bind-Value="knownBot.Username" />
                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto">
                    Submit
                </MudButton>
            </MudCardContent>
        </EditForm>
    </MudCard>
}
@code {
    [Parameter]
    public int id { get; set; }
    private KnownBot? knownBot { get; set; } = new();

    public async void OnSubmit()
    {
        if (knownBot == null) return;
        await KnownBots.AddKnownBot(knownBot);
        navigationManager.NavigateTo($"/knownbots");
    }
}